≠4
VE:\src\NewGenSource\NorthwindBackend\Sennedjem\WebAPI\Controllers\AnimalsController.cs
	namespace 	
WebAPI
 
. 
Controllers 
{		 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
AnimalsController "
:# $
BaseApiController% 6
{ 
[ 	
HttpGet	 
( 
$str 
) 
] 
[ 	
AllowAnonymous	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetList) 0
(0 1
)1 2
{ 	
var 
result 
= 
await 
Mediator '
.' (
Send( ,
(, -
new- 0
GetAnimalsQuery1 @
(@ A
)A B
)B C
;C D
if 
( 
result 
. 
Success 
) 
{ 
return 
Ok 
( 
result  
.  !
Data! %
)% &
;& '
} 
return   

BadRequest   
(   
result   $
.  $ %
Message  % ,
)  , -
;  - .
}!! 	
[)) 	
HttpGet))	 
()) 
$str)) 
))) 
])) 
[** 	
AllowAnonymous**	 
]** 
public++ 
async++ 
Task++ 
<++ 
IActionResult++ '
>++' (
GetById++) 0
(++0 1
int++1 4
animalId++5 =
)++= >
{,, 	
var-- 
result-- 
=-- 
await-- 
Mediator-- '
.--' (
Send--( ,
(--, -
new--- 0
GetAnimalQuery--1 ?
{--@ A
AnimalId--B J
=--K L
animalId--M U
}--V W
)--W X
;--X Y
if.. 
(.. 
result.. 
... 
Success.. 
).. 
{// 
return00 
Ok00 
(00 
result00  
.00  !
Data00! %
)00% &
;00& '
}11 
return22 

BadRequest22 
(22 
result22 $
.22$ %
Message22% ,
)22, -
;22- .
}33 	
[:: 	
HttpPost::	 
]:: 
[;; 	
AllowAnonymous;;	 
];; 
public<< 
async<< 
Task<< 
<<< 
IActionResult<< '
><<' (
Add<<) ,
(<<, -
[<<- .
FromBody<<. 6
]<<6 7
CreateAnimalCommand<<8 K
createAnimal<<L X
)<<X Y
{== 	
var>> 
result>> 
=>> 
await>> 
Mediator>> '
.>>' (
Send>>( ,
(>>, -
createAnimal>>- 9
)>>9 :
;>>: ;
if?? 
(?? 
result?? 
.?? 
Success?? 
)?? 
{@@ 
returnAA 
OkAA 
(AA 
resultAA  
.AA  !
MessageAA! (
)AA( )
;AA) *
}BB 
returnCC 

BadRequestCC 
(CC 
resultCC $
.CC$ %
MessageCC% ,
)CC, -
;CC- .
}DD 	
[KK 	
HttpPutKK	 
]KK 
publicLL 
asyncLL 
TaskLL 
<LL 
IActionResultLL '
>LL' (
UpdateLL) /
(LL/ 0
[LL0 1
FromBodyLL1 9
]LL9 :
UpdateAnimalCommandLL; N
updateAnimalLLO [
)LL[ \
{MM 	
varNN 
resultNN 
=NN 
awaitNN 
MediatorNN '
.NN' (
SendNN( ,
(NN, -
updateAnimalNN- 9
)NN9 :
;NN: ;
ifOO 
(OO 
resultOO 
.OO 
SuccessOO 
)OO 
{PP 
returnQQ 
OkQQ 
(QQ 
resultQQ  
.QQ  !
MessageQQ! (
)QQ( )
;QQ) *
}RR 
returnSS 

BadRequestSS 
(SS 
resultSS $
.SS$ %
MessageSS% ,
)SS, -
;SS- .
}TT 	
[[[ 	

HttpDelete[[	 
][[ 
public\\ 
async\\ 
Task\\ 
<\\ 
IActionResult\\ '
>\\' (
Delete\\) /
(\\/ 0
[\\0 1
FromBody\\1 9
]\\9 :
DeleteAnimalCommand\\; N
deleteAnimal\\O [
)\\[ \
{]] 	
var^^ 
result^^ 
=^^ 
await^^ 
Mediator^^ '
.^^' (
Send^^( ,
(^^, -
deleteAnimal^^- 9
)^^9 :
;^^: ;
if__ 
(__ 
result__ 
.__ 
Success__ 
)__ 
{`` 
returnaa 
Okaa 
(aa 
resultaa  
.aa  !
Messageaa! (
)aa( )
;aa) *
}bb 
returncc 

BadRequestcc 
(cc 
resultcc $
.cc$ %
Messagecc% ,
)cc, -
;cc- .
}dd 	
[jj 	
HttpPostjj	 
(jj 
$strjj $
)jj$ %
]jj% &
[kk 	
AllowAnonymouskk	 
]kk 
publicll 
asyncll 
Taskll 
<ll 
IActionResultll '
>ll' (
TransactionalAddll) 9
(ll9 :
[ll: ;
FromBodyll; C
]llC D/
#AnimalTransactionalOperationCommandllE h&
transactionalCreateAnimal	lli Ç
)
llÇ É
{mm 	
varnn 
resultnn 
=nn 
awaitnn 
Mediatornn '
.nn' (
Sendnn( ,
(nn, -%
transactionalCreateAnimalnn- F
)nnF G
;nnG H
ifoo 
(oo 
resultoo 
.oo 
Successoo 
)oo 
{pp 
returnqq 
Okqq 
(qq 
resultqq  
.qq  !
Messageqq! (
)qq( )
;qq) *
}rr 
returnss 

BadRequestss 
(ss 
resultss $
.ss$ %
Messagess% ,
)ss, -
;ss- .
}tt 	
}uu 
}vv Ø-
SE:\src\NewGenSource\NorthwindBackend\Sennedjem\WebAPI\Controllers\AuthController.cs
	namespace

 	
WebAPI


 
.

 
Controllers

 
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
AuthController 
:  !
BaseApiController" 3
{ 
private 
readonly 
IConfiguration '
_configuration( 6
;6 7
public 
AuthController 
( 
IConfiguration ,
configuration- :
): ;
{ 	
_configuration 
= 
configuration *
;* +
} 	
[## 	 
ProducesResponseType##	 
(## 
typeof## $
(##$ %
LoginUserResult##% 4
)##4 5
,##5 6
$num##7 :
)##: ;
]##; <
[$$ 	
AllowAnonymous$$	 
]$$ 
[%% 	
HttpPost%%	 
(%% 
$str%% 
)%% 
]%% 
public&& 
async&& 
Task&& 
<&& 
IActionResult&& '
>&&' (
Login&&) .
(&&. /
[&&/ 0
FromBody&&0 8
]&&8 9
LoginUserQuery&&: H

loginModel&&I S
)&&S T
{'' 	
var(( 
result(( 
=(( 
await(( 
Mediator(( '
.((' (
Send((( ,
(((, -

loginModel((- 7
)((7 8
;((8 9
if)) 
()) 
result)) 
.)) 
Success)) 
))) 
return** 
Ok** 
(** 
result**  
.**  !
Data**! %
)**% &
;**& '
return++ 
Unauthorized++ 
(++  
result++  &
.++& '
Message++' .
)++. /
;++/ 0
},, 	
[55 	
AllowAnonymous55	 
]55 
[66 	
HttpPost66	 
(66 
$str66 
)66 
]66 
public77 
async77 
Task77 
<77 
IActionResult77 '
>77' (
Verification77) 5
(775 6
[776 7
FromBody777 ?
]77? @
VerifyCidQuery77A O
	verifyCid77P Y
)77Y Z
{88 	
var99 
result99 
=99 
await99 
Mediator99 '
.99' (
Send99( ,
(99, -
	verifyCid99- 6
)996 7
;997 8
if:: 
(:: 
result:: 
.:: 
Success:: 
):: 
return;; 
Ok;; 
(;; 
result;;  
.;;  !
Message;;! (
);;( )
;;;) *
return== 

BadRequest== 
(== 
result== $
.==$ %
Message==% ,
)==, -
;==- .
}>> 	
[EE 	
AllowAnonymousEE	 
]EE 
[FF 	
HttpPostFF	 
(FF 
$strFF 
)FF 
]FF 
publicGG 
asyncGG 
TaskGG 
<GG 
IActionResultGG '
>GG' (
RegisterGG) 1
(GG1 2
[GG2 3
FromBodyGG3 ;
]GG; <
RegisterUserGG= I
.GGI J
CommandGGJ Q

createUserGGR \
)GG\ ]
{HH 	
varII 
resultII 
=II 
awaitII 
MediatorII '
.II' (
SendII( ,
(II, -

createUserII- 7
)II7 8
;II8 9
ifJJ 
(JJ 
resultJJ 
.JJ 
SuccessJJ 
)JJ 
returnKK 
OkKK 
(KK 
resultKK  
)KK  !
;KK! "
returnMM 

BadRequestMM 
(MM 
resultMM $
)MM$ %
;MM% &
}NN 	
[UU 	
HttpPutUU	 
(UU 
$strUU !
)UU! "
]UU" #
publicVV 
asyncVV 
TaskVV 
<VV 
IActionResultVV '
>VV' (
ForgotPasswordVV) 7
(VV7 8
[VV8 9
FromBodyVV9 A
]VVA B!
ForgotPasswordCommandVVC X
forgotPasswordVVY g
)VVg h
{WW 	
varXX 
resultXX 
=XX 
awaitXX 
MediatorXX '
.XX' (
SendXX( ,
(XX, -
forgotPasswordXX- ;
)XX; <
;XX< =
ifYY 
(YY 
resultYY 
.YY 
SuccessYY 
)YY 
returnZZ 
OkZZ 
(ZZ 
resultZZ  
)ZZ  !
;ZZ! "
return\\ 

BadRequest\\ 
(\\ 
result\\ $
)\\$ %
;\\% &
}]] 	
[dd 	
HttpPostdd	 
(dd 
$strdd 
)dd 
]dd 
publicee 
IActionResultee 
	LoginTestee &
(ee& '
)ee' (
{ff 	
vargg 
authgg 
=gg 
Requestgg 
.gg 
Headersgg &
[gg& '
$strgg' 6
]gg6 7
;gg7 8
varhh 
tokenhh 
=hh 
newhh 
	JwtHelperhh %
(hh% &
_configurationhh& 4
)hh4 5
.hh5 6
DecodeTokenhh6 A
(hhA B
authhhB F
)hhF G
;hhG H
returnii 
Okii 
(ii 
tokenii 
)ii 
;ii 
}jj 	
}kk 
}ll ñ_
VE:\src\NewGenSource\NorthwindBackend\Sennedjem\WebAPI\Controllers\BaseApiController.cs
	namespace 	
WebAPI
 
. 
Controllers 
{ 
[ 
	Authorize 
] 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
BaseApiController "
:# $

Controller% /
{ 
private 
	IMediator 
	_mediator #
;# $
	protected 
	IMediator 
Mediator $
=>% '
	_mediator( 1
??=2 5
HttpContext6 A
.A B
RequestServicesB Q
.Q R

GetServiceR \
<\ ]
	IMediator] f
>f g
(g h
)h i
;i j
["" 	
	NonAction""	 
]"" 
	protected## 
IActionResult## 
Success##  '
<##' (
T##( )
>##) *
(##* +
string##+ 1
message##2 9
,##9 :
string##; A
internalMessage##B Q
,##Q R
T##S T
data##U Y
)##Y Z
{$$ 	
return%% 
Success%% 
(%% 
new%% 
	ApiResult%% (
<%%( )
T%%) *
>%%* +
{&& 
Success'' 
='' 
true'' 
,'' 
Message(( 
=(( 
message(( !
,((! "
InternalMessage)) 
=))  !
internalMessage))" 1
,))1 2
Data** 
=** 
data** 
}++ 
)++ 
;++ 
},, 	
[33 	
	NonAction33	 
]33 
	protected44 
IActionResult44 
Success44  '
<44' (
T44( )
>44) *
(44* +
	ApiResult44+ 4
<444 5
T445 6
>446 7
data448 <
)44< =
{55 	
return66 
Ok66 
(66 
data66 
)66 
;66 
}77 	
[@@ 	
	NonAction@@	 
]@@ 
	protectedAA 
IActionResultAA 
CreatedAA  '
<AA' (
TAA( )
>AA) *
(AA* +
stringAA+ 1
messageAA2 9
,AA9 :
stringAA; A
internalMessageAAB Q
,AAQ R
TAAS T
dataAAU Y
)AAY Z
{BB 	
returnCC 
CreatedCC 
(CC 
newCC 
	ApiResultCC (
<CC( )
TCC) *
>CC* +
{DD 
SuccessEE 
=EE 
trueEE 
,EE 
MessageFF 
=FF 
messageFF !
,FF! "
InternalMessageGG 
=GG  !
internalMessageGG" 1
,GG1 2
DataHH 
=HH 
dataHH 
}II 
)II 
;II 
}JJ 	
[QQ 	
	NonActionQQ	 
]QQ 
	protectedRR 
IActionResultRR 
CreatedRR  '
<RR' (
TRR( )
>RR) *
(RR* +
	ApiResultRR+ 4
<RR4 5
TRR5 6
>RR6 7
dataRR8 <
)RR< =
{SS 	
returnTT 

StatusCodeTT 
(TT 
$numTT !
,TT! "
dataTT# '
)TT' (
;TT( )
}UU 	
[^^ 	
	NonAction^^	 
]^^ 
	protected__ 
IActionResult__ 
	NoContent__  )
<__) *
T__* +
>__+ ,
(__, -
string__- 3
message__4 ;
,__; <
string__= C
internalMessage__D S
,__S T
T__U V
data__W [
)__[ \
{`` 	
returnaa 
	NoContentaa 
(aa 
newaa  
	ApiResultaa! *
<aa* +
Taa+ ,
>aa, -
{bb 
Successcc 
=cc 
truecc 
,cc 
Messagedd 
=dd 
messagedd !
,dd! "
InternalMessageee 
=ee  !
internalMessageee" 1
,ee1 2
Dataff 
=ff 
dataff 
}gg 
)gg 
;gg 
}hh 	
[oo 	
	NonActionoo	 
]oo 
	protectedpp 
IActionResultpp 
	NoContentpp  )
<pp) *
Tpp* +
>pp+ ,
(pp, -
	ApiResultpp- 6
<pp6 7
Tpp7 8
>pp8 9
datapp: >
)pp> ?
{qq 	
returnrr 

StatusCoderr 
(rr 
$numrr !
,rr! "
datarr# '
)rr' (
;rr( )
}ss 	
[|| 	
	NonAction||	 
]|| 
	protected}} 
IActionResult}} 

BadRequest}}  *
<}}* +
T}}+ ,
>}}, -
(}}- .
string}}. 4
message}}5 <
,}}< =
string}}> D
internalMessage}}E T
,}}T U
T}}V W
data}}X \
)}}\ ]
{~~ 	
return 

BadRequest 
( 
new !
	ApiResult" +
<+ ,
T, -
>- .
{
ÄÄ 
Success
ÅÅ 
=
ÅÅ 
false
ÅÅ 
,
ÅÅ  
Message
ÇÇ 
=
ÇÇ 
message
ÇÇ !
,
ÇÇ! "
InternalMessage
ÉÉ 
=
ÉÉ  !
internalMessage
ÉÉ" 1
,
ÉÉ1 2
Data
ÑÑ 
=
ÑÑ 
data
ÑÑ 
}
ÖÖ 
)
ÖÖ 
;
ÖÖ 
}
ÜÜ 	
[
çç 	
	NonAction
çç	 
]
çç 
	protected
éé 
IActionResult
éé 

BadRequest
éé  *
<
éé* +
T
éé+ ,
>
éé, -
(
éé- .
	ApiResult
éé. 7
<
éé7 8
T
éé8 9
>
éé9 :
data
éé; ?
)
éé? @
{
èè 	
return
êê 

StatusCode
êê 
(
êê 
$num
êê !
,
êê! "
data
êê# '
)
êê' (
;
êê( )
}
ëë 	
[
öö 	
	NonAction
öö	 
]
öö 
	protected
õõ 
IActionResult
õõ 
Unauthorized
õõ  ,
<
õõ, -
T
õõ- .
>
õõ. /
(
õõ/ 0
string
õõ0 6
message
õõ7 >
,
õõ> ?
string
õõ@ F
internalMessage
õõG V
,
õõV W
T
õõX Y
data
õõZ ^
)
õõ^ _
{
úú 	
return
ùù 
Unauthorized
ùù 
(
ùù  
new
ùù  #
	ApiResult
ùù$ -
<
ùù- .
T
ùù. /
>
ùù/ 0
{
ûû 
Success
üü 
=
üü 
false
üü 
,
üü  
Message
†† 
=
†† 
message
†† !
,
††! "
InternalMessage
°° 
=
°°  !
internalMessage
°°" 1
,
°°1 2
Data
¢¢ 
=
¢¢ 
data
¢¢ 
}
££ 
)
££ 
;
££ 
}
§§ 	
[
´´ 	
	NonAction
´´	 
]
´´ 
	protected
¨¨ 
IActionResult
¨¨ 
Unauthorized
¨¨  ,
<
¨¨, -
T
¨¨- .
>
¨¨. /
(
¨¨/ 0
	ApiResult
¨¨0 9
<
¨¨9 :
T
¨¨: ;
>
¨¨; <
data
¨¨= A
)
¨¨A B
{
≠≠ 	
return
ÆÆ 

StatusCode
ÆÆ 
(
ÆÆ 
$num
ÆÆ !
,
ÆÆ! "
data
ÆÆ# '
)
ÆÆ' (
;
ÆÆ( )
}
ØØ 	
[
∏∏ 	
	NonAction
∏∏	 
]
∏∏ 
	protected
ππ 
IActionResult
ππ 
	Forbidden
ππ  )
<
ππ) *
T
ππ* +
>
ππ+ ,
(
ππ, -
string
ππ- 3
message
ππ4 ;
,
ππ; <
string
ππ= C
internalMessage
ππD S
,
ππS T
T
ππU V
data
ππW [
)
ππ[ \
{
∫∫ 	
return
ªª 
	Forbidden
ªª 
(
ªª 
new
ªª  
	ApiResult
ªª! *
<
ªª* +
T
ªª+ ,
>
ªª, -
{
ºº 
Success
ΩΩ 
=
ΩΩ 
false
ΩΩ 
,
ΩΩ  
Message
ææ 
=
ææ 
message
ææ !
,
ææ! "
InternalMessage
øø 
=
øø  !
internalMessage
øø" 1
,
øø1 2
Data
¿¿ 
=
¿¿ 
data
¿¿ 
}
¡¡ 
)
¡¡ 
;
¡¡ 
}
¬¬ 	
[
…… 	
	NonAction
……	 
]
…… 
	protected
   
IActionResult
   
	Forbidden
    )
<
  ) *
T
  * +
>
  + ,
(
  , -
	ApiResult
  - 6
<
  6 7
T
  7 8
>
  8 9
data
  : >
)
  > ?
{
ÀÀ 	
return
ÃÃ 

StatusCode
ÃÃ 
(
ÃÃ 
$num
ÃÃ !
,
ÃÃ! "
data
ÃÃ# '
)
ÃÃ' (
;
ÃÃ( )
}
ÕÕ 	
[
÷÷ 	
	NonAction
÷÷	 
]
÷÷ 
	protected
◊◊ 
IActionResult
◊◊ 
NotFound
◊◊  (
<
◊◊( )
T
◊◊) *
>
◊◊* +
(
◊◊+ ,
string
◊◊, 2
message
◊◊3 :
,
◊◊: ;
string
◊◊< B
internalMessage
◊◊C R
,
◊◊R S
T
◊◊T U
data
◊◊V Z
)
◊◊Z [
{
ÿÿ 	
return
ŸŸ 
NotFound
ŸŸ 
(
ŸŸ 
new
ŸŸ 
	ApiResult
ŸŸ  )
<
ŸŸ) *
T
ŸŸ* +
>
ŸŸ+ ,
{
⁄⁄ 
Success
€€ 
=
€€ 
false
€€ 
,
€€  
Message
‹‹ 
=
‹‹ 
message
‹‹ !
,
‹‹! "
InternalMessage
›› 
=
››  !
internalMessage
››" 1
,
››1 2
Data
ﬁﬁ 
=
ﬁﬁ 
data
ﬁﬁ 
}
ﬂﬂ 
)
ﬂﬂ 
;
ﬂﬂ 
}
‡‡ 	
[
ÁÁ 	
	NonAction
ÁÁ	 
]
ÁÁ 
	protected
ËË 
IActionResult
ËË 
NotFound
ËË  (
<
ËË( )
T
ËË) *
>
ËË* +
(
ËË+ ,
	ApiResult
ËË, 5
<
ËË5 6
T
ËË6 7
>
ËË7 8
data
ËË9 =
)
ËË= >
{
ÈÈ 	
return
ÍÍ 

StatusCode
ÍÍ 
(
ÍÍ 
$num
ÍÍ !
,
ÍÍ! "
data
ÍÍ# '
)
ÍÍ' (
;
ÍÍ( )
}
ÎÎ 	
[
ÙÙ 	
	NonAction
ÙÙ	 
]
ÙÙ 
	protected
ıı 
IActionResult
ıı 
Error
ıı  %
<
ıı% &
T
ıı& '
>
ıı' (
(
ıı( )
string
ıı) /
message
ıı0 7
,
ıı7 8
string
ıı9 ?
internalMessage
ıı@ O
,
ııO P
T
ııQ R
data
ııS W
)
ııW X
{
ˆˆ 	
return
˜˜ 
Error
˜˜ 
(
˜˜ 
new
˜˜ 
	ApiResult
˜˜ &
<
˜˜& '
T
˜˜' (
>
˜˜( )
{
¯¯ 
Success
˘˘ 
=
˘˘ 
false
˘˘ 
,
˘˘  
Message
˙˙ 
=
˙˙ 
message
˙˙ !
,
˙˙! "
InternalMessage
˚˚ 
=
˚˚  !
internalMessage
˚˚" 1
,
˚˚1 2
Data
¸¸ 
=
¸¸ 
data
¸¸ 
}
˝˝ 
)
˝˝ 
;
˝˝ 
}
˛˛ 	
[
ÖÖ 	
	NonAction
ÖÖ	 
]
ÖÖ 
	protected
ÜÜ 
IActionResult
ÜÜ 
Error
ÜÜ  %
<
ÜÜ% &
T
ÜÜ& '
>
ÜÜ' (
(
ÜÜ( )
	ApiResult
ÜÜ) 2
<
ÜÜ2 3
T
ÜÜ3 4
>
ÜÜ4 5
data
ÜÜ6 :
)
ÜÜ: ;
{
áá 	
return
àà 

StatusCode
àà 
(
àà 
$num
àà !
,
àà! "
data
àà# '
)
àà' (
;
àà( )
}
ââ 	
}
ää 
}ãã œ+
WE:\src\NewGenSource\NorthwindBackend\Sennedjem\WebAPI\Controllers\CustomerController.cs
	namespace 	
WebAPI
 
. 
Controllers 
{		 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
CustomerController #
:$ %
BaseApiController& 7
{ 
[ 	
HttpGet	 
( 
$str 
) 
] 
[ 	
AllowAnonymous	 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetList) 0
(0 1
)1 2
{ 	
var 
result 
= 
await 
Mediator '
.' (
Send( ,
(, -
new- 0
GetCustomersQuery1 B
(B C
)C D
)D E
;E F
if 
( 
result 
. 
Success 
) 
{ 
return 
Ok 
( 
result  
.  !
Data! %
)% &
;& '
}   
return!! 

BadRequest!! 
(!! 
result!! $
.!!$ %
Message!!% ,
)!!, -
;!!- .
}"" 	
[** 	
HttpGet**	 
(** 
$str** 
)** 
]** 
[++ 	
AllowAnonymous++	 
]++ 
public,, 
async,, 
Task,, 
<,, 
IActionResult,, '
>,,' (
GetById,,) 0
(,,0 1
ObjectId,,1 9
Id,,: <
),,< =
{-- 	
var.. 
result.. 
=.. 
await.. 
Mediator.. '
...' (
Send..( ,
(.., -
new..- 0
GetCustomerQuery..1 A
{..B C
Id..D F
=..G H
Id..I K
}..L M
)..M N
;..N O
if// 
(// 
result// 
.// 
Success// 
)// 
{00 
return11 
Ok11 
(11 
result11  
.11  !
Data11! %
)11% &
;11& '
}22 
return33 

BadRequest33 
(33 
result33 $
.33$ %
Message33% ,
)33, -
;33- .
}44 	
[;; 	
HttpPost;;	 
];; 
[<< 	
AllowAnonymous<<	 
]<< 
public== 
async== 
Task== 
<== 
IActionResult== '
>==' (
Add==) ,
(==, -
[==- .
FromBody==. 6
]==6 7!
CreateCustomerCommand==8 M
createCustomer==N \
)==\ ]
{>> 	
var?? 
result?? 
=?? 
await?? 
Mediator?? '
.??' (
Send??( ,
(??, -
createCustomer??- ;
)??; <
;??< =
if@@ 
(@@ 
result@@ 
.@@ 
Success@@ 
)@@ 
{AA 
returnBB 
OkBB 
(BB 
resultBB  
.BB  !
MessageBB! (
)BB( )
;BB) *
}CC 
returnDD 

BadRequestDD 
(DD 
resultDD $
.DD$ %
MessageDD% ,
)DD, -
;DD- .
}EE 	
[LL 	
HttpPutLL	 
]LL 
publicMM 
asyncMM 
TaskMM 
<MM 
IActionResultMM '
>MM' (
UpdateMM) /
(MM/ 0
[MM0 1
FromBodyMM1 9
]MM9 :!
UpdateCustomerCommandMM; P
updateCustomerMMQ _
)MM_ `
{NN 	
varOO 
resultOO 
=OO 
awaitOO 
MediatorOO '
.OO' (
SendOO( ,
(OO, -
updateCustomerOO- ;
)OO; <
;OO< =
ifPP 
(PP 
resultPP 
.PP 
SuccessPP 
)PP 
{QQ 
returnRR 
OkRR 
(RR 
resultRR  
.RR  !
MessageRR! (
)RR( )
;RR) *
}SS 
returnTT 

BadRequestTT 
(TT 
resultTT $
.TT$ %
MessageTT% ,
)TT, -
;TT- .
}UU 	
[\\ 	

HttpDelete\\	 
]\\ 
public]] 
async]] 
Task]] 
<]] 
IActionResult]] '
>]]' (
Delete]]) /
(]]/ 0
[]]0 1
FromBody]]1 9
]]]9 :!
DeleteCustomerCommand]]; P
deleteCustomer]]Q _
)]]_ `
{^^ 	
var__ 
result__ 
=__ 
await__ 
Mediator__ '
.__' (
Send__( ,
(__, -
deleteCustomer__- ;
)__; <
;__< =
if`` 
(`` 
result`` 
.`` 
Success`` 
)`` 
{aa 
returnbb 
Okbb 
(bb 
resultbb  
.bb  !
Messagebb! (
)bb( )
;bb) *
}cc 
returndd 

BadRequestdd 
(dd 
resultdd $
.dd$ %
Messagedd% ,
)dd, -
;dd- .
}ee 	
}gg 
}hh ˜
YE:\src\NewGenSource\NorthwindBackend\Sennedjem\WebAPI\Controllers\ManagementController.cs
	namespace 	
WebAPI
 
. 
Controllers 
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class  
ManagementController %
:& '
ControllerBase( 6
{ 
private 
readonly 
IActivityMonitor )
monitor* 1
;1 2
public  
ManagementController #
(# $
IActivityMonitor$ 4
monitor5 <
)< =
{ 	
this 
. 
monitor 
= 
monitor "
;" #
} 	
[ 	 
ProducesResponseType	 
( 
typeof $
($ %
ActivityMonitor% 4
.4 5
ActivitySummary5 D
)D E
,E F
$numG J
)J K
]K L
[   	
HttpGet  	 
(   
$str   
)   
]    
public!! 
ActionResult!! 
Performance!! '
(!!' (
)!!( )
{"" 	
return## 
Ok## 
(## 
monitor## 
.## 
	Summarize## '
(##' (
)##( )
)##) *
;##* +
}$$ 	
}%% 
}&& ∏.
WE:\src\NewGenSource\NorthwindBackend\Sennedjem\WebAPI\Controllers\ProductsController.cs
	namespace		 	
WebAPI		
 
.		 
Controllers		 
{

 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
ProductsController #
:$ %
BaseApiController& 7
{ 
[ 	
HttpGet	 
( 
$str 
) 
] 
public 
async 
Task 
< 
IActionResult '
>' (
GetList) 0
(0 1
)1 2
{ 	
var 
result 
= 
await 
Mediator '
.' (
Send( ,
(, -
new- 0
GetProductsQuery1 A
(A B
)B C
)C D
;D E
if 
( 
result 
. 
Success 
) 
{ 
return 
Ok 
( 
result  
.  !
Data! %
)% &
;& '
}   
return!! 

BadRequest!! 
(!! 
result!! $
.!!$ %
Message!!% ,
)!!, -
;!!- .
}"" 	
[** 	
HttpGet**	 
(** 
$str** 
)** 
]** 
public++ 
async++ 
Task++ 
<++ 
IActionResult++ '
>++' (
GetById++) 0
(++0 1
int++1 4
	productId++5 >
)++> ?
{,, 	
var-- 
result-- 
=-- 
await-- 
Mediator-- '
.--' (
Send--( ,
(--, -
new--- 0
GetProductQuery--1 @
{--A B
	ProductId--C L
=--M N
	productId--O X
}--Y Z
)--Z [
;--[ \
if.. 
(.. 
result.. 
... 
Success.. 
).. 
{// 
return00 
Ok00 
(00 
result00  
.00  !
Data00! %
)00% &
;00& '
}11 
return22 

BadRequest22 
(22 
result22 $
.22$ %
Message22% ,
)22, -
;22- .
}33 	
[:: 	
HttpPost::	 
]:: 
[;; 	
AllowAnonymous;;	 
];; 
[<< 	 
ProducesResponseType<<	 
(<< 
$num<< !
,<<! "
Type<<# '
=<<( )
typeof<<* 0
(<<0 1
SuccessResult<<1 >
)<<> ?
)<<? @
]<<@ A
[== 	 
ProducesResponseType==	 
(== 
$num== !
,==! "
Type==# '
===( )
typeof==* 0
(==0 1
ErrorResult==1 <
)==< =
)=== >
]==> ?
public>> 
async>> 
Task>> 
<>> 
IActionResult>> '
>>>' (
Add>>) ,
(>>, -
[>>- .
FromBody>>. 6
]>>6 7 
CreateProductCommand>>8 L
createProduct>>M Z
)>>Z [
{?? 	
var@@ 
result@@ 
=@@ 
await@@ 
Mediator@@ '
.@@' (
Send@@( ,
(@@, -
createProduct@@- :
)@@: ;
;@@; <
ifAA 
(AA 
resultAA 
.AA 
SuccessAA 
)AA 
{BB 
returnCC 
OkCC 
(CC 
resultCC  
.CC  !
MessageCC! (
)CC( )
;CC) *
}DD 
returnEE 

BadRequestEE 
(EE 
resultEE $
.EE$ %
MessageEE% ,
)EE, -
;EE- .
}FF 	
[MM 	
HttpPutMM	 
]MM 
publicNN 
asyncNN 
TaskNN 
<NN 
IActionResultNN '
>NN' (
UpdateNN) /
(NN/ 0
[NN0 1
FromBodyNN1 9
]NN9 : 
UpdateProductCommandNN; O
updateProductNNP ]
)NN] ^
{OO 	
varPP 
resultPP 
=PP 
awaitPP 
MediatorPP '
.PP' (
SendPP( ,
(PP, -
updateProductPP- :
)PP: ;
;PP; <
ifQQ 
(QQ 
resultQQ 
.QQ 
SuccessQQ 
)QQ 
{RR 
returnSS 
OkSS 
(SS 
resultSS  
.SS  !
MessageSS! (
)SS( )
;SS) *
}TT 
returnUU 

BadRequestUU 
(UU 
resultUU $
.UU$ %
MessageUU% ,
)UU, -
;UU- .
}VV 	
[]] 	

HttpDelete]]	 
]]] 
public^^ 
async^^ 
Task^^ 
<^^ 
IActionResult^^ '
>^^' (
Delete^^) /
(^^/ 0
[^^0 1
FromBody^^1 9
]^^9 : 
DeleteProductCommand^^; O
deleteProduct^^P ]
)^^] ^
{__ 	
var`` 
result`` 
=`` 
await`` 
Mediator`` '
.``' (
Send``( ,
(``, -
deleteProduct``- :
)``: ;
;``; <
ifaa 
(aa 
resultaa 
.aa 
Successaa 
)aa 
{bb 
returncc 
Okcc 
(cc 
resultcc  
.cc  !
Messagecc! (
)cc( )
;cc) *
}dd 
returnee 

BadRequestee 
(ee 
resultee $
.ee$ %
Messageee% ,
)ee, -
;ee- .
}ff 	
}gg 
}hh ’
@E:\src\NewGenSource\NorthwindBackend\Sennedjem\WebAPI\Program.cs
	namespace 	
WebAPI
 
{ 
public 

class 
Program 
{ 
public 
static 
void 
Main 
(  
string  &
[& '
]' (
args) -
)- .
{ 	
CreateHostBuilder 
( 
args "
)" #
.# $
Build$ )
() *
)* +
.+ ,
Run, /
(/ 0
)0 1
;1 2
var 
logger 
= 
NLog 
. 
Web !
.! "
NLogBuilder" -
.- .
ConfigureNLog. ;
(; <
$str< I
)I J
.J K!
GetCurrentClassLoggerK `
(` a
)a b
;b c
try 
{ 
logger 
. 
Debug 
( 
$str )
)) *
;* +
CreateHostBuilder !
(! "
args" &
)& '
.' (
Build( -
(- .
). /
./ 0
Run0 3
(3 4
)4 5
;5 6
} 
catch   
(   
	Exception   
	exception   &
)  & '
{!! 
logger"" 
."" 
Error"" 
("" 
	exception"" &
,""& '
$str""( ?
)""? @
;""@ A
throw## 
;## 
}$$ 
finally%% 
{&& 
NLog(( 
.(( 

LogManager(( 
.((  
Shutdown((  (
(((( )
)(() *
;((* +
})) 
}** 	
public00 
static00 
IHostBuilder00 "
CreateHostBuilder00# 4
(004 5
string005 ;
[00; <
]00< =
args00> B
)00B C
=>00D F
Host11 
.11  
CreateDefaultBuilder11 )
(11) *
args11* .
)11. /
.22 %
UseServiceProviderFactory22 .
(22. /
new22/ 2)
AutofacServiceProviderFactory223 P
(22P Q
)22Q R
)22R S
.33 $
ConfigureWebHostDefaults33 -
(33- .

webBuilder33. 8
=>339 ;
{44 

webBuilder55 "
.55" #

UseStartup55# -
<55- .
Startup55. 5
>555 6
(556 7
)557 8
;558 9
}66 
)66 
.77 	
ConfigureLogging77	 
(77 
logging77 !
=>77" $
{88 	
logging99 
.99 
ClearProviders99 "
(99" #
)99# $
;99$ %
logging:: 
.:: 
SetMinimumLevel:: #
(::# $
	Microsoft::$ -
.::- .

Extensions::. 8
.::8 9
Logging::9 @
.::@ A
LogLevel::A I
.::I J
Trace::J O
)::O P
;::P Q
};; 	
);;	 

.<< 	
UseNLog<<	 
(<< 
)<< 
;<< 
}>> 
}?? ÇI
@E:\src\NewGenSource\NorthwindBackend\Sennedjem\WebAPI\Startup.cs
	namespace 	
WebAPI
 
{ 
public 

partial 
class 
Startup  
:! "
Business# +
.+ ,
BusinessStartup, ;
{ 
public!! 
Startup!! 
(!! 
IConfiguration!! %
configuration!!& 3
,!!3 4
IHostEnvironment!!5 E
hostEnvironment!!F U
)!!U V
:"" 
base"" 
("" 
configuration""  
,""  !
hostEnvironment""" 1
)""1 2
{## 	
}$$ 	
public// 
override// 
void// 
ConfigureServices// .
(//. /
IServiceCollection/// A
services//B J
)//J K
{00 	
services33 
.33 
AddControllers33 #
(33# $
)33$ %
.55 
AddJsonOptions55 
(55  
options55  '
=>55( *
{66 
options77 
.77 !
JsonSerializerOptions77 1
.771 2

Converters772 <
.77< =
Add77= @
(77@ A
new77A D#
JsonStringEnumConverter77E \
(77\ ]
)77] ^
)77^ _
;77_ `
options88 
.88 !
JsonSerializerOptions88 1
.881 2
IgnoreNullValues882 B
=88C D
true88E I
;88I J
}99 
)99 
;:: 
services<< 
.<< 
AddCors<< 
(<< 
options<< $
=><<% '
{== 
options>> 
.>> 
	AddPolicy>> !
(>>! "
$str>>" /
,>>/ 0
builder??$ +
=>??, .
builder??/ 6
.??6 7
AllowAnyOrigin??7 E
(??E F
)??F G
.??G H
AllowAnyMethod??H V
(??V W
)??W X
.??X Y
AllowAnyHeader??Y g
(??g h
)??h i
)??i j
;??j k
}@@ 
)@@ 
;@@ 
varBB 
tokenOptionsBB 
=BB 
ConfigurationBB ,
.BB, -

GetSectionBB- 7
(BB7 8
$strBB8 F
)BBF G
.BBG H
GetBBH K
<BBK L
TokenOptionsBBL X
>BBX Y
(BBY Z
)BBZ [
;BB[ \
servicesDD 
.DD 
AddAuthenticationDD &
(DD& '
JwtBearerDefaultsDD' 8
.DD8 9 
AuthenticationSchemeDD9 M
)DDM N
.EE 
AddJwtBearerEE !
(EE! "
optionsEE" )
=>EE* ,
{FF 
optionsGG 
.GG  %
TokenValidationParametersGG  9
=GG: ;
newGG< ?%
TokenValidationParametersGG@ Y
{HH 
ValidateIssuerII *
=II+ ,
trueII- 1
,II1 2
ValidateAudienceJJ ,
=JJ- .
trueJJ/ 3
,JJ3 4
ValidateLifetimeKK ,
=KK- .
trueKK/ 3
,KK3 4
ValidIssuerLL '
=LL( )
tokenOptionsLL* 6
.LL6 7
IssuerLL7 =
,LL= >
ValidAudienceMM )
=MM* +
tokenOptionsMM, 8
.MM8 9
AudienceMM9 A
,MMA B$
ValidateIssuerSigningKeyNN 4
=NN5 6
trueNN7 ;
,NN; <
IssuerSigningKeyOO ,
=OO- .
SecurityKeyHelperOO/ @
.OO@ A
CreateSecurityKeyOOA R
(OOR S
tokenOptionsOOS _
.OO_ `
SecurityKeyOO` k
)OOk l
,OOl m
	ClockSkewPP %
=PP& '
TimeSpanPP( 0
.PP0 1
ZeroPP1 5
}QQ 
;QQ 
}RR 
)RR 
;RR 
servicesSS 
.SS 
AddSwaggerGenSS "
(SS" #
cSS# $
=>SS% '
{TT 
cUU 
.UU 
IncludeXmlCommentsUU $
(UU$ %
PathUU% )
.UU) *
ChangeExtensionUU* 9
(UU9 :
typeofUU: @
(UU@ A
StartupUUA H
)UUH I
.UUI J
AssemblyUUJ R
.UUR S
LocationUUS [
,UU[ \
$strUU] c
)UUc d
)UUd e
;UUe f
}VV 
)VV 
;VV 
servicesXX 
.XX 
AddTransientXX !
<XX! "

FileLoggerXX" ,
>XX, -
(XX- .
)XX. /
;XX/ 0
servicesYY 
.YY 
AddTransientYY !
<YY! "
PostgreSqlLoggerYY" 2
>YY2 3
(YY3 4
)YY4 5
;YY5 6
base[[ 
.[[ 
ConfigureServices[[ "
([[" #
services[[# +
)[[+ ,
;[[, -
}\\ 	
publicdd 
voiddd 
	Configuredd 
(dd 
IApplicationBuilderdd 1
appdd2 5
,dd5 6
IWebHostEnvironmentdd7 J
envddK N
)ddN O
{ee 	
ServiceToolhh 
.hh 
ServiceProviderhh '
=hh( )
apphh* -
.hh- .
ApplicationServiceshh. A
;hhA B
varkk  
configurationManagerkk $
=kk% &
appkk' *
.kk* +
ApplicationServiceskk+ >
.kk> ?

GetServicekk? I
<kkI J 
ConfigurationManagerkkJ ^
>kk^ _
(kk_ `
)kk` a
;kka b
switchll 
(ll  
configurationManagerll (
.ll( )
Modell) -
)ll- .
{mm 
casenn 
ApplicationModenn $
.nn$ %
Developmentnn% 0
:nn0 1
caseoo 
ApplicationModeoo $
.oo$ %
	Profilingoo% .
:oo. /
casepp 
ApplicationModepp $
.pp$ %
Stagingpp% ,
:pp, -
breakrr 
;rr 
casess 
ApplicationModess $
.ss$ %

Productionss% /
:ss/ 0
breaktt 
;tt 
}uu 
ifvv 
(vv 
envvv 
.vv 
IsDevelopmentvv !
(vv! "
)vv" #
||vv$ &
envvv' *
.vv* +
	IsStagingvv+ 4
(vv4 5
)vv5 6
)vv6 7
{ww 
}xx 
appyy 
.yy %
UseDeveloperExceptionPageyy )
(yy) *
)yy* +
;yy+ ,
app{{ 
.{{ .
"ConfigureCustomExceptionMiddleware{{ 2
({{2 3
){{3 4
;{{4 5
app}} 
.}} &
UseDbOperationClaimCreator}} *
(}}* +
)}}+ ,
;}}, -
app~~ 
.~~ 

UseSwagger~~ 
(~~ 
)~~ 
;~~ 
app
ÄÄ 
.
ÄÄ 
UseSwaggerUI
ÄÄ 
(
ÄÄ 
c
ÄÄ 
=>
ÄÄ !
{
ÅÅ 
c
ÇÇ 
.
ÇÇ 
SwaggerEndpoint
ÇÇ !
(
ÇÇ! "
$str
ÇÇ" 3
,
ÇÇ3 4
$str
ÇÇ5 :
)
ÇÇ: ;
;
ÇÇ; <
}
ÑÑ 
)
ÑÑ 
;
ÑÑ 
app
ÖÖ 
.
ÖÖ 
UseCors
ÖÖ 
(
ÖÖ 
$str
ÖÖ %
)
ÖÖ% &
;
ÖÖ& '
app
áá 
.
áá !
UseHttpsRedirection
áá #
(
áá# $
)
áá$ %
;
áá% &
app
ââ 
.
ââ 

UseRouting
ââ 
(
ââ 
)
ââ 
;
ââ 
app
ãã 
.
ãã 
UseAuthentication
ãã !
(
ãã! "
)
ãã" #
;
ãã# $
app
çç 
.
çç 
UseAuthorization
çç  
(
çç  !
)
çç! "
;
çç" #
app
êê 
.
êê $
UseRequestLocalization
êê &
(
êê& '
new
êê' *(
RequestLocalizationOptions
êê+ E
{
ëë #
DefaultRequestCulture
íí %
=
íí& '
new
íí( +
RequestCulture
íí, :
(
íí: ;
$str
íí; B
)
ííB C
,
ííC D
}
îî 
)
îî 
;
îî 
var
ññ 
cultureInfo
ññ 
=
ññ 
new
ññ !
CultureInfo
ññ" -
(
ññ- .
$str
ññ. 5
)
ññ5 6
;
ññ6 7
cultureInfo
óó 
.
óó 
DateTimeFormat
óó &
.
óó& '
ShortTimePattern
óó' 7
=
óó8 9
$str
óó: A
;
óóA B
CultureInfo
ôô 
.
ôô )
DefaultThreadCurrentCulture
ôô 3
=
ôô4 5
cultureInfo
ôô6 A
;
ôôA B
CultureInfo
öö 
.
öö +
DefaultThreadCurrentUICulture
öö 5
=
öö6 7
cultureInfo
öö8 C
;
ööC D
app
úú 
.
úú 
UseStaticFiles
úú 
(
úú 
)
úú  
;
úú  !
app
ûû 
.
ûû 
UseEndpoints
ûû 
(
ûû 
	endpoints
ûû &
=>
ûû' )
{
üü 
	endpoints
†† 
.
†† 
MapControllers
†† (
(
††( )
)
††) *
;
††* +
}
°° 
)
°° 
;
°° 
}
§§ 	
}
•• 
}¶¶ 